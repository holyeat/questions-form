(this.webpackJsonptodos=this.webpackJsonptodos||[]).push([[0],{184:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),i=r(86),c=r(6),s=r(7),o=r(9),l=r(8),u=r(10),p=r(16),h=function(e){function t(e){return Object(c.a)(this,t),Object(o.a)(this,Object(l.a)(t).call(this,e))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return this.props.error.length<1?n.a.createElement("div",null):n.a.createElement("div",{className:"form__text-error active"},n.a.createElement("span",null,"!"),this.props.error)}}]),t}(n.a.Component),d=function(e){function t(e){var r;Object(c.a)(this,t),(r=Object(o.a)(this,Object(l.a)(t).call(this,e))).handleChange=r.handleChange.bind(Object(p.a)(r));r.props.config.variants;var a=r.props.parent.getCurrentValue();return null!==a&&a.length>0&&(r.props.config.variants=r.props.config.variants.reduce((function(e,t){return t.checked=a===t.value,t.showMyVariant=!1,console.log(t,a),void 0!==t.title&&(t.showMyVariant=a===t.value),e.push(t),e}),[])),r.forceUpdate(),r}return Object(u.a)(t,e),Object(s.a)(t,[{key:"handleOnClick",value:function(e){null!==e.value&&(console.log(this.props),this.props.parent.dispatch({type:"submitSingleChoice",variant:e,step:this.props.config}));var t=this.props.config.variants;this.props.config.variants=this.props.config.variants.reduce((function(r,a){return a.title===e.title&&null===e.value?(e.showMyVariant=!t.reduce((function(e,t){return e.push(t.title),e}),[]).includes(a.value),console.log(e.showMyVariant),r.push(a),r):(r.push(a),r)}),[]),this.forceUpdate()}},{key:"handleChange",value:function(e){this.props.config.variants=this.props.config.variants.reduce((function(t,r){return void 0!==r.title&&(r.value=e.target.value),t.push(r),t}),[]),this.props.parent.dispatch({type:"changeCurrentValue",currentValue:e.target.value}),this.forceUpdate()}},{key:"render",value:function(){var e=this;return console.log(this.props.config),n.a.createElement("div",{className:"form__main"}," ",n.a.createElement("div",{className:"form__main-text"},n.a.createElement("ul",null,n.a.createElement("li",null,n.a.createElement("span",null,"*")," - Required"))),n.a.createElement("div",{className:"form__main-title"},n.a.createElement("h2",null,this.props.config.title,n.a.createElement("span",null,this.props.config.required?"*":""))),n.a.createElement("div",{className:"form__group"},n.a.createElement("div",{className:"from__group-radio"},this.props.config.variants.map((function(t){return console.log(void 0!==t.showMyVariant&&!1!==t.showMyVariant),n.a.createElement("div",null,n.a.createElement("input",{checked:t.checked,type:"radio",value:t.value,name:t.title,id:t.title}),n.a.createElement("label",{onClick:function(){return e.handleOnClick(t)},htmlFor:t.title},void 0!==t.custom?t.title:t.value),n.a.createElement("input",{onChange:e.handleChange,value:e.props.parent.getCurrentValue(),style:void 0!==t.showMyVariant&&!1!==t.showMyVariant?{display:"block"}:{display:"none"},type:"text",placeholder:"My variant"}))})))),n.a.createElement(h,{error:this.props.parent.getError()}))}}]),t}(n.a.Component),m=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(o.a)(this,Object(l.a)(t).call(this,e))).handleChange=r.handleChange.bind(Object(p.a)(r)),r}return Object(u.a)(t,e),Object(s.a)(t,[{key:"handleChange",value:function(e){this.props.parent.dispatch({type:"changeCurrentValue",currentValue:e.target.value}),this.forceUpdate()}},{key:"render",value:function(){return n.a.createElement("div",{className:"form__main"}," ",n.a.createElement("div",{className:"form__main-text"},n.a.createElement("ul",null,n.a.createElement("li",null,n.a.createElement("span",null,"*")," - Required"))),n.a.createElement("div",{className:"form__main-title"},n.a.createElement("h2",null,this.props.config.title,n.a.createElement("span",null,this.props.config.required?"*":""))),n.a.createElement("div",{className:"form__group"},n.a.createElement("input",{type:"text",onChange:this.handleChange,placeholder:this.props.config.placeholder,value:this.props.parent.getCurrentValue()})),n.a.createElement(h,{error:this.props.parent.getError()}))}}]),t}(n.a.Component),f=function(e){function t(e){return Object(c.a)(this,t),Object(o.a)(this,Object(l.a)(t).call(this,e))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"handleOnClick",value:function(e){var t=[];this.props.config.variants=this.props.config.variants.reduce((function(r,a){return e.value===a.value&&a.checked?(a.checked=0,r.push(a),r):(e.checked&&t.push(a.value),e.value!==a.value||a.checked?(r.push(a),r):(a.checked=1,r.push(a),r))}),[]),console.log(t),this.props.parent.dispatch({type:"changeCurrentValue",currentValue:t}),this.forceUpdate()}},{key:"render",value:function(){var e=this;return console.log(this.props.config),n.a.createElement("div",{className:"form__main"}," ",n.a.createElement("div",{className:"form__main-text"},n.a.createElement("ul",null,n.a.createElement("li",null,n.a.createElement("span",null,"*")," - Required"))),n.a.createElement("div",{className:"form__main-title"},n.a.createElement("h2",null,this.props.config.title,n.a.createElement("span",null,this.props.config.required?"*":""))),n.a.createElement("div",{className:"form__group"},this.props.config.variants.map((function(t){return n.a.createElement("div",{className:"from__group-radio"},n.a.createElement("input",{checked:t.checked,type:"checkbox",value:t.value,name:t.title,id:t.value}),n.a.createElement("label",{onClick:function(){return e.handleOnClick(t)},htmlFor:t.value},t.value))}))),n.a.createElement(h,{error:this.props.parent.getError()}))}}]),t}(n.a.Component),v=function(e){function t(e){var r;Object(c.a)(this,t),(r=Object(o.a)(this,Object(l.a)(t).call(this,e))).handleChange=r.handleChange.bind(Object(p.a)(r)),r.increment=r.increment.bind(Object(p.a)(r)),r.decrement=r.decrement.bind(Object(p.a)(r));var a=r.props.parent.getCurrentValue()>0?r.props.parent.getCurrentValue():0;return r.props.parent.dispatch({type:"changeCurrentValue",currentValue:a}),r.forceUpdate(),r}return Object(u.a)(t,e),Object(s.a)(t,[{key:"handleChange",value:function(e){this.props.parent.dispatch({type:"changeCurrentValue",currentValue:e.target.value}),this.forceUpdate()}},{key:"increment",value:function(){this.props.parent.dispatch({type:"changeCurrentValue",currentValue:this.props.parent.getCurrentValue()+1}),this.forceUpdate()}},{key:"decrement",value:function(){var e=this.props.parent.getCurrentValue();e<=0||(this.props.parent.dispatch({type:"changeCurrentValue",currentValue:e-1}),this.forceUpdate())}},{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement("div",{className:"form__main-title"},n.a.createElement("h2",null,this.props.config.title,n.a.createElement("span",null,this.props.config.required?"*":""))),n.a.createElement("div",{className:"form__group form__group--calc"},n.a.createElement("button",{className:"form__btn-calc",onClick:this.decrement,type:"button"},"-"),n.a.createElement("input",{className:"form__input-calc",type:"text",onChange:this.handleChange,value:this.props.parent.getCurrentValue()}),n.a.createElement("button",{className:"form__btn-calc",onClick:this.increment,type:"button"},"+")),n.a.createElement(h,{error:this.props.parent.getError()}))}}]),t}(n.a.Component),b=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(o.a)(this,Object(l.a)(t).call(this,e))).value="",r.props.state.subscribe((function(){return r.props.state.getState()})),r}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(e){var t,r=this.props.step;switch(r.type){case"input":t=n.a.createElement(m,{config:r,parent:this});break;case"single-choice":t=n.a.createElement(d,{config:r,parent:this});break;case"multiple-choice":t=n.a.createElement(f,{config:r,parent:this});break;case"numeric":t=n.a.createElement(v,{config:r,parent:this})}return n.a.createElement("div",null,t)}},{key:"getError",value:function(){return this.props.state.getState().error}},{key:"dispatch",value:function(e){this.props.state.dispatch(e)}},{key:"getCurrentValue",value:function(){return this.props.state.getState().currentValue}}]),t}(n.a.Component),g=function(e){function t(e){return Object(c.a)(this,t),Object(o.a)(this,Object(l.a)(t).call(this,e))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"previousStep",value:function(e){return e.preventDefault(),this.props.parent.previousStep(),!1}},{key:"render",value:function(){console.log(this.props.step);var e=this.props.step.questionNumber/this.props.step.total*100;return 1===this.props.step.questionNumber&&(e=0),n.a.createElement("div",{className:"form__header"},n.a.createElement("div",{className:"form__header-title"},n.a.createElement("h3",null,"Step ",this.props.step.sectionNumber,":",n.a.createElement("span",null,this.props.step.section))),n.a.createElement("style",{dangerouslySetInnerHTML:{__html:[".form__header-line:before {","  width: "+e+"%","}"].join("\n")}}),n.a.createElement("div",{className:"form__header-line"}),n.a.createElement("div",{className:"form__header-bottom"},n.a.createElement("a",{className:"form__arrow active",href:"#",onClick:this.previousStep.bind(this)},"back"),n.a.createElement("div",{className:"from__header-number"},n.a.createElement("span",null,this.props.step.questionNumber),"/",this.props.step.total)))}}]),t}(n.a.Component),E=function(e){function t(e){return Object(c.a)(this,t),Object(o.a)(this,Object(l.a)(t).call(this,e))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"submit",value:function(){this.props.parent.submit(this.props.parent.value)}},{key:"clearForm",value:function(e){e.preventDefault(),this.props.parent.clearForm()}},{key:"render",value:function(){return n.a.createElement("div",{className:"form__footer"},n.a.createElement("a",{className:"form__footer-text",onClick:this.clearForm.bind(this),href:"#",style:{color:"red"}},"Clear all answers"),n.a.createElement("a",{className:"form__btn",onClick:this.submit.bind(this)},"Next"))}}]),t}(n.a.Component);var y=function(e,t){return fetch(window.host+"/launch-api/internal/api/state-store/"+t+"/"+e,{credentials:"include",method:"DELETE",mode:"cors",redirect:"follow",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:window.token}}).then((function(e){return e.json()}))},j=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(o.a)(this,Object(l.a)(t).call(this,e))).props.state.subscribe((function(){return r.props.state.getState()})),r}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(e){var t=this;this.props.state.subscribe((function(){t.forceUpdate()}));window.config;var r=this.props.state.getState().steps[this.props.state.getState().currentStep];return this.currentStep=r,console.log(r),n.a.createElement("div",{className:"form",action:"/",method:"POST"},n.a.createElement(g,{step:r,parent:this}),n.a.createElement(b,{state:this.props.state,step:r}),n.a.createElement(E,{step:r,parent:this,state:this.props.state}),n.a.createElement("a",{href:window.config.nextStepUrl,className:"form__footer-text",style:{maxWidth:"120px"}},"Fill the form later"))}},{key:"clearForm",value:function(){var e=this;this.props.state.dispatch({type:"load"}),this.forceUpdate(),y("form",window.userId).then((function(){e.props.state.dispatch({type:"clear"}),e.forceUpdate()}))}},{key:"previousStep",value:function(){this.props.state.dispatch({type:"previousStep"})}},{key:"submit",value:function(e){this.props.state.dispatch({type:"nextStep",step:this.currentStep,value:e})}}]),t}(n.a.Component),O=r(12);var _=function(e){var t=[],r=0,a=0;for(var n in e)for(var i in a++,e[n].questions){r++;var c=e[n].questions[i];c.section=e[n].title,c.questionNumber=r,c.sectionNumber=a,t.push(c)}var s=t.length;for(var o in t)t[o].total=s;return t};var C=function(e,t,r){return fetch(window.host+"/launch-api/internal/api/state-store",{credentials:"include",method:"PATCH",mode:"cors",redirect:"follow",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:window.token},body:JSON.stringify({data:{type:"state_stores",id:"new",attributes:{type:e,state:r},relationships:{user:{data:{id:t,type:"users"}}}}})}).then((function(e){return e.json()}))},k={currentStep:0,steps:_(window.config.questions.steps),answers:[],currentValue:"",error:"",isLoaded:!1};function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0;return function(){var r={currentStep:0,steps:_(window.config.questions.steps),answers:[],currentValue:"",error:"",isLoaded:!1};switch(t.type){case"reload":return Object(O.a)({},e,{isLoaded:!0});case"load":return Object(O.a)({},e,{isLoaded:!1});case"clear":return Object(O.a)({},r,{isLoaded:!0});case"ready":return Object(O.a)({},e,{isLoaded:!0});case"nextStep":var a=e.steps[e.currentStep];return e.currentValue=void 0===e.currentValue||null===e.currentValue?"":e.currentValue,a.required&&e.currentValue.length<1&&["input","single-choice"].includes(a.type)?Object(O.a)({},e,{currentStep:e.currentStep,error:"This field is required"}):(console.log(a.required,"multiple-choice"===a.type,e.currentValue,e.currentValue.length),!a.required||"multiple-choice"!==a.type||null!==e.currentValue&&0!==e.currentValue.length?a.required&&"numeric"===a.type&&0===e.currentValue?Object(O.a)({},e,{currentStep:e.currentStep,error:"This field is required"}):(e.answers[e.currentStep]=e.currentValue,e.currentValue="",e=Object(O.a)({},e,{currentStep:e.currentStep+1,error:""}),C("form",window.userId,e),e):Object(O.a)({},e,{currentStep:e.currentStep,error:"This field is required"}));case"previousStep":if(0===e.currentStep)return e;var n=e.currentStep-1;return Object(O.a)({},e,{currentStep:n,currentValue:e.answers[n],error:""});case"changeCurrentValue":return e=Object(O.a)({},e,{currentValue:t.currentValue});case"submitSingleChoice":return e.answers[e.currentStep]=t.variant.value,console.log(e),e=Object(O.a)({},e,{currentStep:e.currentStep+1,error:""}),C("form",window.userId,e),e;default:return e}}()}var V=r(88);var S=function(e,t){return fetch(window.host+"/launch-api/internal/api/state-store/"+t+"/"+e,{credentials:"include",method:"GET",mode:"cors",redirect:"follow",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:window.token}}).then((function(e){return e.json()}))},N=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(o.a)(this,Object(l.a)(t).call(this,e))).initialState={},r.state=Object(V.a)(w),r.state.subscribe((function(){r.forceUpdate()})),S("form",window.userId).then((function(e){if("undefined"===typeof e.data)return r.state.dispatch({type:"ready"}),void r.forceUpdate();r.state.dispatch({type:"reload",state:e.data.attributes.state}),r.forceUpdate()})),r}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return this.state.getState().isLoaded?n.a.createElement("div",null,n.a.createElement(j,{state:this.state,parent:this})):n.a.createElement("div",{className:"wait-spinner"},n.a.createElement("div",{className:"lds-roller"},n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null)))}}]),t}(n.a.Component);window.api||(window.api="http://localhost:904/api/v1/"),Object(i.render)(n.a.createElement(N,null),document.getElementById("root"))},89:function(e,t,r){e.exports=r(184)}},[[89,1,2]]]);
//# sourceMappingURL=main.51230428.chunk.js.map